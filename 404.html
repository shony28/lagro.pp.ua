<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Redirecting...</title>
    <script>
        (function() {
            var path = window.location.pathname;
            var parts = path.substring(1).split('/').filter(p => p); // убираем первый слеш и пустые элементы
            
            // Если путь пустой - на главную
            if (parts.length === 0) {
                window.location.replace('/');
                return;
            }
            
            // Проверяем, является ли первый элемент spreadsheetId (40+ символов)
            var isSpreadsheetId = parts[0] && /^[A-Za-z0-9_-]{40,}$/.test(parts[0]);
            
            if (isSpreadsheetId) {
                // Старый формат с ID в URL: /spreadsheetId/goodsId/359
                var params = new URLSearchParams();
                params.set('id', decodeURIComponent(parts[0]));
                
                // Остальные параметры
                for (var i = 1; i < parts.length; i += 2) {
                    if (parts[i] && parts[i + 1]) {
                        params.set(parts[i], decodeURIComponent(parts[i + 1]));
                    }
                }
                
                var newUrl = '/shop.html?' + params.toString();
                window.history.replaceState(null, null, newUrl);
                window.location.replace(newUrl);
            } else {
                // Новый формат без ID: /goodsId/359
                var params = new URLSearchParams();
                
                // Все параметры парами
                for (var i = 0; i < parts.length; i += 2) {
                    if (parts[i] && parts[i + 1]) {
                        params.set(parts[i], decodeURIComponent(parts[i + 1]));
                    }
                }
                
                var newUrl = '/shop.html?' + params.toString();
                window.history.replaceState(null, null, newUrl);
                window.location.replace(newUrl);
            }
        })();
    </script>
</head>
<body>
    <p>Redirecting...</p>
</body>
</html>
